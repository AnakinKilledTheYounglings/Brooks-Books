{"ast":null,"code":"var _jsxFileName = \"/Users/BrooksCole/Documents/reading-community/frontend/src/pages/BookGallery.js\",\n  _s = $RefreshSig$();\n// frontend/src/pages/BookGallery.js\nimport React, { useState, useEffect } from 'react';\nimport { Container, Grid, Typography, TextField, Box, Button, Paper, Snackbar, Alert, Chip, IconButton, Collapse, Dialog, DialogTitle, DialogContent } from '@mui/material';\nimport { CloudUpload, ExpandMore, ExpandLess, Quiz as QuizIcon, Close as CloseIcon } from '@mui/icons-material';\nimport DrawingCard from '../components/DrawingCard';\nimport FilterBar from '../components/FilterBar';\nimport VocabularyQuiz from '../components/VocabularyQuiz';\nimport { Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction BookGallery() {\n  _s();\n  // State declarations (unchanged)\n  const [books, setBooks] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [selectedGenre, setSelectedGenre] = useState(null);\n  const [snackbar, setSnackbar] = useState({\n    open: false,\n    message: '',\n    severity: 'success'\n  });\n  const [expandedBooks, setExpandedBooks] = useState({});\n  const [selectedTag, setSelectedTag] = useState(null);\n  const [openQuiz, setOpenQuiz] = useState(false);\n  const [activeQuizBookId, setActiveQuizBookId] = useState(null);\n  const [openBookDialog, setOpenBookDialog] = useState(false);\n\n  // Effects and handlers (unchanged)\n  useEffect(() => {\n    fetchBooks();\n  }, []);\n\n  // Your existing handler functions remain the same\n  const handleExpandBook = bookId => {\n    setExpandedBooks(prev => ({\n      ...prev,\n      [bookId]: !prev[bookId]\n    }));\n  };\n  const fetchBooks = async () => {\n    try {\n      const response = await fetch('http://localhost:3001/api/books');\n      const data = await response.json();\n      setBooks(data);\n      setLoading(false);\n    } catch (err) {\n      setError('Failed to load books');\n      setLoading(false);\n    }\n  };\n  const handleDrawingUpload = async (bookId, file, event) => {\n    event.preventDefault();\n    const formData = new FormData();\n    formData.append('drawing', file);\n    try {\n      const response = await fetch(`http://localhost:3001/api/books/${bookId}/drawings`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: formData\n      });\n      if (response.ok) {\n        setSnackbar({\n          open: true,\n          message: 'Drawing uploaded successfully!',\n          severity: 'success'\n        });\n        fetchBooks();\n      } else {\n        const data = await response.json();\n        setSnackbar({\n          open: true,\n          message: data.error || 'Failed to upload drawing',\n          severity: 'error'\n        });\n      }\n    } catch (err) {\n      console.error('Upload error:', err);\n      setSnackbar({\n        open: true,\n        message: 'Error uploading drawing',\n        severity: 'error'\n      });\n    }\n  };\n  const handleCloseSnackbar = () => {\n    setSnackbar({\n      ...snackbar,\n      open: false\n    });\n  };\n  const filteredBooks = books.filter(book => (searchTerm === '' || book.title.toLowerCase().includes(searchTerm.toLowerCase()) || book.author.toLowerCase().includes(searchTerm.toLowerCase())) && (!selectedGenre || book.genres && book.genres.includes(selectedGenre)) && (!selectedTag || book.tags && book.tags.includes(selectedTag)));\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h5\",\n        sx: {\n          mt: 4\n        },\n        children: \"Loading books...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        color: \"error\",\n        sx: {\n          mt: 4\n        },\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"lg\",\n    sx: {\n      mt: 4\n    },\n    children: [/*#__PURE__*/_jsxDEV(FilterBar, {\n      selectedGenre: selectedGenre,\n      onGenreSelect: setSelectedGenre,\n      selectedTag: selectedTag,\n      onTagSelect: setSelectedTag\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        mb: 4\n      },\n      children: /*#__PURE__*/_jsxDEV(TextField, {\n        fullWidth: true,\n        label: \"Search books...\",\n        variant: \"outlined\",\n        value: searchTerm,\n        onChange: e => setSearchTerm(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        flexGrow: 1\n      },\n      children: /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 4,\n        sx: {\n          '& .MuiGrid-item': {\n            transition: 'none'\n          }\n        },\n        children: filteredBooks.map(book => /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 6,\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Paper, {\n            elevation: 3,\n            sx: {\n              transition: 'all 0.3s ease',\n              '&:hover': {\n                transform: 'translateY(-4px)',\n                boxShadow: 6\n              },\n              borderRadius: '12px',\n              overflow: 'hidden',\n              backgroundColor: 'background.paper',\n              position: 'relative'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Box, {\n              onClick: () => handleExpandBook(book._id),\n              sx: {\n                cursor: 'pointer',\n                position: 'relative'\n              },\n              children: [book.drawings && book.drawings.length > 0 ? /*#__PURE__*/_jsxDEV(Box, {\n                sx: {\n                  width: '100%',\n                  height: 200,\n                  overflow: 'hidden',\n                  borderTopLeftRadius: 4,\n                  borderTopRightRadius: 4\n                },\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: book.drawings.reduce((mostLiked, current) => {\n                    var _current$likes, _mostLiked$likes;\n                    const currentLikes = ((_current$likes = current.likes) === null || _current$likes === void 0 ? void 0 : _current$likes.length) || 0;\n                    const mostLikedCount = ((_mostLiked$likes = mostLiked.likes) === null || _mostLiked$likes === void 0 ? void 0 : _mostLiked$likes.length) || 0;\n                    return currentLikes > mostLikedCount ? current : mostLiked;\n                  }, book.drawings[0]).imageUrl,\n                  alt: `Most liked drawing for ${book.title}`,\n                  style: {\n                    width: '100%',\n                    height: '100%',\n                    objectFit: 'cover'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 206,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(Box, {\n                sx: {\n                  width: '100%',\n                  height: 200,\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  bgcolor: 'grey.200',\n                  borderTopLeftRadius: 4,\n                  borderTopRightRadius: 4\n                },\n                children: /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body2\",\n                  color: \"text.secondary\",\n                  children: \"No drawings yet\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 231,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n                sx: {\n                  position: 'absolute',\n                  bottom: 8,\n                  right: 8,\n                  backgroundColor: 'rgba(255, 255, 255, 0.9)',\n                  backdropFilter: 'blur(4px)',\n                  '&:hover': {\n                    backgroundColor: 'rgba(255, 255, 255, 1)',\n                    transform: 'scale(1.1)'\n                  },\n                  transition: 'all 0.2s ease',\n                  boxShadow: '0 2px 8px rgba(0,0,0,0.1)'\n                },\n                children: expandedBooks[book._id] ? /*#__PURE__*/_jsxDEV(ExpandLess, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 48\n                }, this) : /*#__PURE__*/_jsxDEV(ExpandMore, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 65\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              sx: {\n                p: 3\n              },\n              children: [/*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"h5\",\n                gutterBottom: true,\n                children: book.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"subtitle1\",\n                color: \"text.secondary\",\n                gutterBottom: true,\n                children: [\"by \", book.author]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 19\n              }, this), book.genres && /*#__PURE__*/_jsxDEV(Box, {\n                sx: {\n                  mb: 2,\n                  display: 'flex',\n                  gap: 0.5,\n                  flexWrap: 'wrap'\n                },\n                children: book.genres.map(genre => /*#__PURE__*/_jsxDEV(Chip, {\n                  label: genre,\n                  size: \"small\",\n                  variant: \"outlined\",\n                  sx: {\n                    fontSize: '0.75rem',\n                    height: '24px',\n                    borderRadius: '6px',\n                    backgroundColor: 'rgba(25, 118, 210, 0.08)',\n                    borderColor: 'primary.main',\n                    '&:hover': {\n                      backgroundColor: 'rgba(25, 118, 210, 0.15)'\n                    }\n                  }\n                }, genre, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 269,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                component: Link,\n                to: `/books/${book._id}/vocabulary`,\n                variant: \"contained\",\n                color: \"primary\",\n                fullWidth: true,\n                sx: {\n                  mb: 2\n                },\n                children: \"Vocabulary Training\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 290,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Collapse, {\n                in: expandedBooks[book._id],\n                children: /*#__PURE__*/_jsxDEV(Box, {\n                  sx: {\n                    mt: 2\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"contained\",\n                    component: \"label\",\n                    startIcon: /*#__PURE__*/_jsxDEV(CloudUpload, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 308,\n                      columnNumber: 36\n                    }, this),\n                    fullWidth: true,\n                    sx: {\n                      borderRadius: '8px',\n                      textTransform: 'none',\n                      py: 1.5,\n                      background: 'linear-gradient(45deg, #2196F3 30%, #21CBF3 90%)',\n                      boxShadow: '0 3px 5px 2px rgba(33, 203, 243, .3)',\n                      '&:hover': {\n                        background: 'linear-gradient(45deg, #2196F3 60%, #21CBF3 90%)'\n                      }\n                    },\n                    children: [\"Upload Drawing\", /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"file\",\n                      hidden: true,\n                      accept: \"image/*\",\n                      onChange: e => {\n                        if (e.target.files[0]) {\n                          handleDrawingUpload(book._id, e.target.files[0], e);\n                        }\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 322,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 305,\n                    columnNumber: 23\n                  }, this), book.drawings && book.drawings.length > 0 && /*#__PURE__*/_jsxDEV(Box, {\n                    sx: {\n                      mt: 2\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(Typography, {\n                      variant: \"h6\",\n                      gutterBottom: true,\n                      children: [\"Drawings (\", book.drawings.length, \")\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 337,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                      container: true,\n                      spacing: 1,\n                      children: book.drawings.map((drawing, index) => /*#__PURE__*/_jsxDEV(Grid, {\n                        item: true,\n                        xs: 12,\n                        children: /*#__PURE__*/_jsxDEV(DrawingCard, {\n                          drawing: drawing,\n                          bookId: book._id,\n                          onLikeUpdate: fetchBooks\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 343,\n                          columnNumber: 33\n                        }, this)\n                      }, index, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 342,\n                        columnNumber: 31\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 340,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 336,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Box, {\n                    sx: {\n                      mt: 2\n                    },\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      variant: \"contained\",\n                      color: \"secondary\",\n                      fullWidth: true,\n                      onClick: () => {\n                        setOpenQuiz(true);\n                        setActiveQuizBookId(book._id);\n                      },\n                      startIcon: /*#__PURE__*/_jsxDEV(QuizIcon, {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 364,\n                        columnNumber: 38\n                      }, this),\n                      children: \"Take Vocabulary Quiz\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 356,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 355,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n                    open: openQuiz && activeQuizBookId & openBookDialog === book._id,\n                    onClose: () => setOpenQuiz(false),\n                    maxWidth: \"md\",\n                    fullWidth: true,\n                    children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n                      children: [\"Vocabulary Quiz - \", book.title, /*#__PURE__*/_jsxDEV(IconButton, {\n                        \"aria-label\": \"close\",\n                        onClick: () => setOpenQuiz(false),\n                        sx: {\n                          position: 'absolute',\n                          right: 8,\n                          top: 8\n                        },\n                        children: /*#__PURE__*/_jsxDEV(CloseIcon, {}, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 384,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 379,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 377,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n                      children: /*#__PURE__*/_jsxDEV(VocabularyQuiz, {\n                        bookId: book._id\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 388,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 387,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 371,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Box, {\n                    sx: {\n                      mt: 2\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(TextField, {\n                      fullWidth: true,\n                      label: \"Add your tags (comma-separated)\",\n                      size: \"small\",\n                      value: book.tagInput || '',\n                      onChange: e => {\n                        setBooks(books.map(b => b._id === book._id ? {\n                          ...b,\n                          tagInput: e.target.value\n                        } : b));\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 394,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Button, {\n                      size: \"small\",\n                      onClick: async () => {\n                        try {\n                          const newTags = book.tagInput.split(',').map(tag => tag.trim()).filter(tag => tag);\n                          const response = await fetch(`http://localhost:3001/api/books/${book._id}/tags`, {\n                            method: 'POST',\n                            headers: {\n                              'Content-Type': 'application/json',\n                              'Authorization': `Bearer ${localStorage.getItem('token')}`\n                            },\n                            body: JSON.stringify({\n                              tags: newTags\n                            })\n                          });\n                          if (response.ok) {\n                            fetchBooks();\n                          }\n                        } catch (error) {\n                          console.error('Error adding tags:', error);\n                        }\n                      },\n                      sx: {\n                        mt: 1\n                      },\n                      children: \"Add Tags\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 407,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 393,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 303,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 302,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 15\n          }, this)\n        }, book._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n      open: snackbar.open,\n      autoHideDuration: 6000,\n      onClose: handleCloseSnackbar,\n      anchorOrigin: {\n        vertical: 'bottom',\n        horizontal: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        onClose: handleCloseSnackbar,\n        severity: snackbar.severity,\n        sx: {\n          width: '100%'\n        },\n        children: snackbar.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 146,\n    columnNumber: 5\n  }, this);\n}\n_s(BookGallery, \"zXf7sukb/qWpFtCYyMB91fmic/8=\");\n_c = BookGallery;\nexport default BookGallery;\nvar _c;\n$RefreshReg$(_c, \"BookGallery\");","map":{"version":3,"names":["React","useState","useEffect","Container","Grid","Typography","TextField","Box","Button","Paper","Snackbar","Alert","Chip","IconButton","Collapse","Dialog","DialogTitle","DialogContent","CloudUpload","ExpandMore","ExpandLess","Quiz","QuizIcon","Close","CloseIcon","DrawingCard","FilterBar","VocabularyQuiz","Link","jsxDEV","_jsxDEV","BookGallery","_s","books","setBooks","searchTerm","setSearchTerm","loading","setLoading","error","setError","selectedGenre","setSelectedGenre","snackbar","setSnackbar","open","message","severity","expandedBooks","setExpandedBooks","selectedTag","setSelectedTag","openQuiz","setOpenQuiz","activeQuizBookId","setActiveQuizBookId","openBookDialog","setOpenBookDialog","fetchBooks","handleExpandBook","bookId","prev","response","fetch","data","json","err","handleDrawingUpload","file","event","preventDefault","formData","FormData","append","method","headers","localStorage","getItem","body","ok","console","handleCloseSnackbar","filteredBooks","filter","book","title","toLowerCase","includes","author","genres","tags","children","variant","sx","mt","fileName","_jsxFileName","lineNumber","columnNumber","color","maxWidth","onGenreSelect","onTagSelect","mb","fullWidth","label","value","onChange","e","target","flexGrow","container","spacing","transition","map","item","xs","sm","md","elevation","transform","boxShadow","borderRadius","overflow","backgroundColor","position","onClick","_id","cursor","drawings","length","width","height","borderTopLeftRadius","borderTopRightRadius","src","reduce","mostLiked","current","_current$likes","_mostLiked$likes","currentLikes","likes","mostLikedCount","imageUrl","alt","style","objectFit","display","alignItems","justifyContent","bgcolor","bottom","right","backdropFilter","p","gutterBottom","gap","flexWrap","genre","size","fontSize","borderColor","component","to","in","startIcon","textTransform","py","background","type","hidden","accept","files","drawing","index","onLikeUpdate","onClose","top","tagInput","b","newTags","split","tag","trim","JSON","stringify","autoHideDuration","anchorOrigin","vertical","horizontal","_c","$RefreshReg$"],"sources":["/Users/BrooksCole/Documents/reading-community/frontend/src/pages/BookGallery.js"],"sourcesContent":["// frontend/src/pages/BookGallery.js\nimport React, { useState, useEffect } from 'react';\nimport { \n  Container, \n  Grid, \n  Typography, \n  TextField, \n  Box,\n  Button,\n  Paper,\n  Snackbar,\n  Alert,\n  Chip,\n  IconButton,\n  Collapse,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n} from '@mui/material';\nimport { \n  CloudUpload,\n  ExpandMore,\n  ExpandLess,\n  Quiz as QuizIcon,\n  Close as CloseIcon,\n} from '@mui/icons-material';\nimport DrawingCard from '../components/DrawingCard';\nimport FilterBar from '../components/FilterBar';\nimport VocabularyQuiz from '../components/VocabularyQuiz';\nimport { Link } from 'react-router-dom';\n\n\nfunction BookGallery() {\n  // State declarations (unchanged)\n  const [books, setBooks] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [selectedGenre, setSelectedGenre] = useState(null);\n  const [snackbar, setSnackbar] = useState({\n    open: false,\n    message: '',\n    severity: 'success'\n  });\n  const [expandedBooks, setExpandedBooks] = useState({});\n  const [selectedTag, setSelectedTag] = useState(null);\n  const [openQuiz, setOpenQuiz] = useState(false);\n  const [activeQuizBookId, setActiveQuizBookId] = useState(null);\n  const [openBookDialog, setOpenBookDialog] = useState(false);\n  \n\n  // Effects and handlers (unchanged)\n  useEffect(() => {\n    fetchBooks();\n  }, []);\n\n  // Your existing handler functions remain the same\n  const handleExpandBook = (bookId) => {\n    setExpandedBooks(prev => ({\n      ...prev,\n      [bookId]: !prev[bookId]\n    }));\n  };\n\n  const fetchBooks = async () => {\n    try {\n      const response = await fetch('http://localhost:3001/api/books');\n      const data = await response.json();\n      setBooks(data);\n      setLoading(false);\n    } catch (err) {\n      setError('Failed to load books');\n      setLoading(false);\n    }\n  };\n\n  const handleDrawingUpload = async (bookId, file, event) => {\n    event.preventDefault();\n    const formData = new FormData();\n    formData.append('drawing', file);\n\n    try {\n      const response = await fetch(`http://localhost:3001/api/books/${bookId}/drawings`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: formData\n      });\n\n      if (response.ok) {\n        setSnackbar({\n          open: true,\n          message: 'Drawing uploaded successfully!',\n          severity: 'success'\n        });\n        fetchBooks();\n      } else {\n        const data = await response.json();\n        setSnackbar({\n          open: true,\n          message: data.error || 'Failed to upload drawing',\n          severity: 'error'\n        });\n      }\n    } catch (err) {\n      console.error('Upload error:', err);\n      setSnackbar({\n        open: true,\n        message: 'Error uploading drawing',\n        severity: 'error'\n      });\n    }\n  };\n\n  const handleCloseSnackbar = () => {\n    setSnackbar({ ...snackbar, open: false });\n  };\n\n  const filteredBooks = books.filter(book => \n    (searchTerm === '' || \n      book.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      book.author.toLowerCase().includes(searchTerm.toLowerCase())\n    ) &&\n    (!selectedGenre || (book.genres && book.genres.includes(selectedGenre))) &&\n    (!selectedTag || (book.tags && book.tags.includes(selectedTag)))\n  );\n\n  if (loading) {\n    return (\n      <Container>\n        <Typography variant=\"h5\" sx={{ mt: 4 }}>Loading books...</Typography>\n      </Container>\n    );\n  }\n  \n  if (error) {\n    return (\n      <Container>\n        <Typography color=\"error\" sx={{ mt: 4 }}>{error}</Typography>\n      </Container>\n    );\n  }\n\n  return (\n    <Container maxWidth=\"lg\" sx={{ mt: 4 }}>\n      <FilterBar\n        selectedGenre={selectedGenre}\n        onGenreSelect={setSelectedGenre}\n        selectedTag={selectedTag}\n        onTagSelect={setSelectedTag}\n      />\n      \n      <Box sx={{ mb: 4 }}>\n        <TextField\n          fullWidth\n          label=\"Search books...\"\n          variant=\"outlined\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n        />\n      </Box>\n\n      <Box sx={{ flexGrow: 1 }}>\n        <Grid \n          container \n          spacing={4}\n          sx={{\n            '& .MuiGrid-item': {\n              transition: 'none',\n            }\n          }}\n        >\n          {filteredBooks.map((book) => (\n            <Grid item xs={12} sm={6} md={4} key={book._id}>\n              <Paper \n                elevation={3} \n                sx={{ \n                  transition: 'all 0.3s ease',\n                  '&:hover': {\n                    transform: 'translateY(-4px)',\n                    boxShadow: 6\n                  },\n                  borderRadius: '12px',\n                  overflow: 'hidden',\n                  backgroundColor: 'background.paper',\n                  position: 'relative'\n                }}\n              >\n                {/* Cover Image / Most Liked Drawing */}\n                <Box\n                  onClick={() => handleExpandBook(book._id)}\n                  sx={{ \n                    cursor: 'pointer',\n                    position: 'relative'\n                  }}\n                >\n                  {book.drawings && book.drawings.length > 0 ? (\n                    <Box sx={{ \n                      width: '100%', \n                      height: 200, \n                      overflow: 'hidden',\n                      borderTopLeftRadius: 4,\n                      borderTopRightRadius: 4\n                    }}>\n                      <img\n                        src={book.drawings.reduce((mostLiked, current) => {\n                          const currentLikes = current.likes?.length || 0;\n                          const mostLikedCount = mostLiked.likes?.length || 0;\n                          return currentLikes > mostLikedCount ? current : mostLiked;\n                        }, book.drawings[0]).imageUrl}\n                        alt={`Most liked drawing for ${book.title}`}\n                        style={{\n                          width: '100%',\n                          height: '100%',\n                          objectFit: 'cover'\n                        }}\n                      />\n                    </Box>\n                  ) : (\n                    <Box sx={{\n                      width: '100%',\n                      height: 200,\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      bgcolor: 'grey.200',\n                      borderTopLeftRadius: 4,\n                      borderTopRightRadius: 4\n                    }}>\n                      <Typography variant=\"body2\" color=\"text.secondary\">\n                        No drawings yet\n                      </Typography>\n                    </Box>\n                  )}\n                  \n                  {/* Expand/Collapse Indicator */}\n                  <IconButton \n                    sx={{ \n                      position: 'absolute', \n                      bottom: 8, \n                      right: 8,\n                      backgroundColor: 'rgba(255, 255, 255, 0.9)',\n                      backdropFilter: 'blur(4px)',\n                      '&:hover': {\n                        backgroundColor: 'rgba(255, 255, 255, 1)',\n                        transform: 'scale(1.1)'\n                      },\n                      transition: 'all 0.2s ease',\n                      boxShadow: '0 2px 8px rgba(0,0,0,0.1)'\n                    }}\n                  >\n                    {expandedBooks[book._id] ? <ExpandLess /> : <ExpandMore />}\n                  </IconButton>\n                </Box>\n          \n                <Box sx={{ p: 3 }}>\n                  <Typography variant=\"h5\" gutterBottom>\n                    {book.title}\n                  </Typography>\n                  <Typography variant=\"subtitle1\" color=\"text.secondary\" gutterBottom>\n                    by {book.author}\n                  </Typography>\n                  \n                  {/* Genres and Age Range */}\n                  {book.genres && (\n                    <Box sx={{ mb: 2, display: 'flex', gap: 0.5, flexWrap: 'wrap' }}>\n                      {book.genres.map((genre) => (\n                        <Chip\n                          key={genre}\n                          label={genre}\n                          size=\"small\"\n                          variant=\"outlined\"\n                          sx={{\n                            fontSize: '0.75rem',\n                            height: '24px',\n                            borderRadius: '6px',\n                            backgroundColor: 'rgba(25, 118, 210, 0.08)',\n                            borderColor: 'primary.main',\n                            '&:hover': {\n                              backgroundColor: 'rgba(25, 118, 210, 0.15)',\n                            }\n                          }}\n                        />\n                      ))}\n                    </Box>\n                  )}\n\n                  {/* Vocabulary Training Button */}\n                  <Button \n                    component={Link} \n                    to={`/books/${book._id}/vocabulary`}\n                    variant=\"contained\"\n                    color=\"primary\"\n                    fullWidth\n                    sx={{ mb: 2 }}\n                  >\n                    Vocabulary Training\n                  </Button>\n          \n                  {/* Expanded Content */}\n                  <Collapse in={expandedBooks[book._id]}>\n                    <Box sx={{ mt: 2 }}>\n                      {/* Drawing Upload Button */}\n                      <Button\n                        variant=\"contained\"\n                        component=\"label\"\n                        startIcon={<CloudUpload />}\n                        fullWidth\n                        sx={{\n                          borderRadius: '8px',\n                          textTransform: 'none',\n                          py: 1.5,\n                          background: 'linear-gradient(45deg, #2196F3 30%, #21CBF3 90%)',\n                          boxShadow: '0 3px 5px 2px rgba(33, 203, 243, .3)',\n                          '&:hover': {\n                            background: 'linear-gradient(45deg, #2196F3 60%, #21CBF3 90%)',\n                          }\n                        }}\n                      >\n                        Upload Drawing\n                        <input\n                          type=\"file\"\n                          hidden\n                          accept=\"image/*\"\n                          onChange={(e) => {\n                            if (e.target.files[0]) {\n                              handleDrawingUpload(book._id, e.target.files[0], e);\n                            }\n                          }}\n                        />\n                      </Button>\n\n                      {/* Drawings Grid */}\n                      {book.drawings && book.drawings.length > 0 && (\n                        <Box sx={{ mt: 2 }}>\n                          <Typography variant=\"h6\" gutterBottom>\n                            Drawings ({book.drawings.length})\n                          </Typography>\n                          <Grid container spacing={1}>\n                            {book.drawings.map((drawing, index) => (\n                              <Grid item xs={12} key={index}>\n                                <DrawingCard\n                                  drawing={drawing}\n                                  bookId={book._id}\n                                  onLikeUpdate={fetchBooks}\n                                />\n                              </Grid>\n                            ))}\n                          </Grid>\n                        </Box>\n                      )}\n\n                      {/* Vocabulary Quiz Button */}\n                      <Box sx={{ mt: 2 }}>\n                        <Button\n                          variant=\"contained\"\n                          color=\"secondary\"\n                          fullWidth\n                          onClick={() => {\n                            setOpenQuiz(true);\n                            setActiveQuizBookId(book._id);\n                          }}\n                          startIcon={<QuizIcon />}\n                        >\n                          Take Vocabulary Quiz\n                        </Button>\n                      </Box>\n                      \n                      {/* Quiz Dialog */}\n                      <Dialog \n                        open={openQuiz && activeQuizBookId & openBookDialog === book._id} \n                        onClose={() => setOpenQuiz(false)}\n                        maxWidth=\"md\"\n                        fullWidth\n                      >\n                        <DialogTitle>\n                          Vocabulary Quiz - {book.title}\n                          <IconButton\n                            aria-label=\"close\"\n                            onClick={() => setOpenQuiz(false)}\n                            sx={{ position: 'absolute', right: 8, top: 8 }}\n                          >\n                            <CloseIcon />\n                          </IconButton>\n                        </DialogTitle>\n                        <DialogContent>\n                          <VocabularyQuiz bookId={book._id} />\n                        </DialogContent>\n                      </Dialog>\n\n                      {/* Tags Section */}\n                      <Box sx={{ mt: 2 }}>\n                        <TextField\n                          fullWidth\n                          label=\"Add your tags (comma-separated)\"\n                          size=\"small\"\n                          value={book.tagInput || ''}\n                          onChange={(e) => {\n                            setBooks(books.map(b => \n                              b._id === book._id \n                                ? { ...b, tagInput: e.target.value }\n                                : b\n                            ));\n                          }}\n                        />\n                        <Button\n                          size=\"small\"\n                          onClick={async () => {\n                            try {\n                              const newTags = book.tagInput\n                                .split(',')\n                                .map(tag => tag.trim())\n                                .filter(tag => tag);\n                      \n                              const response = await fetch(`http://localhost:3001/api/books/${book._id}/tags`, {\n                                method: 'POST',\n                                headers: {\n                                  'Content-Type': 'application/json',\n                                  'Authorization': `Bearer ${localStorage.getItem('token')}`\n                                },\n                                body: JSON.stringify({ tags: newTags })\n                              });\n                      \n                              if (response.ok) {\n                                fetchBooks();\n                              }\n                            } catch (error) {\n                              console.error('Error adding tags:', error);\n                            }\n                          }}\n                          sx={{ mt: 1 }}\n                        >\n                          Add Tags\n                        </Button>\n                      </Box>\n                    </Box>\n                  </Collapse>\n                </Box>\n              </Paper>\n            </Grid>\n          ))}\n        </Grid>\n      </Box>\n\n      <Snackbar \n        open={snackbar.open} \n        autoHideDuration={6000} \n        onClose={handleCloseSnackbar}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n      >\n        <Alert \n          onClose={handleCloseSnackbar} \n          severity={snackbar.severity}\n          sx={{ width: '100%' }}\n        >\n          {snackbar.message}\n        </Alert>\n      </Snackbar>\n    </Container>\n  );\n}\n\nexport default BookGallery;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}