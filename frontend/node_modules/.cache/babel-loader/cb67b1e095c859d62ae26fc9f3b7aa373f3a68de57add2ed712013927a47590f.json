{"ast":null,"code":"// frontend/src/components/Navbar.js\nimport React,{useState,useEffect}from'react';import{AppBar,Toolbar,Typography,Button,Box,IconButton}from'@mui/material';import{Brightness4 as DarkIcon,Brightness7 as LightIcon}from'@mui/icons-material';import{Link as RouterLink,useNavigate}from'react-router-dom';import ThemeToggle from'./ThemeToggle';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function Navbar(_ref){let{toggleTheme,currentTheme}=_ref;const[isLoggedIn,setIsLoggedIn]=useState(false);const[isAdmin,setIsAdmin]=useState(false);const navigate=useNavigate();useEffect(()=>{const checkAuthStatus=async()=>{const token=localStorage.getItem('token');console.log('Checking auth with token:',token);if(token){// First check stored user data\nconst storedUser=JSON.parse(localStorage.getItem('user'));if(storedUser){setIsLoggedIn(true);setIsAdmin(storedUser.isAdmin===true);}try{const response=await fetch('http://localhost:3001/api/auth/profile',{headers:{'Authorization':`Bearer ${token}`}});const data=await response.json();console.log('Profile response:',data);if(response.ok){setIsLoggedIn(true);setIsAdmin(data.isAdmin===true);console.log('Is admin?',data.isAdmin);}else{console.log('Auth check failed:',data);localStorage.removeItem('token');localStorage.removeItem('user');setIsLoggedIn(false);setIsAdmin(false);}}catch(error){console.error('Auth check error:',error);setIsLoggedIn(false);setIsAdmin(false);}}};checkAuthStatus();},[localStorage.getItem('lastLogin')]);// Add lastLogin as dependency\nconst handleLogout=()=>{localStorage.removeItem('token');localStorage.removeItem('user');localStorage.removeItem('lastLogin');setIsLoggedIn(false);setIsAdmin(false);navigate('/login');};return/*#__PURE__*/_jsx(AppBar,{position:\"fixed\",style:{zIndex:1100},children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"div\",sx:{flexGrow:1},children:\"Brooks'Bookhouse\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Box,{sx:{mr:2},children:/*#__PURE__*/_jsx(ThemeToggle,{currentTheme:currentTheme,toggleTheme:toggleTheme})}),/*#__PURE__*/_jsx(Button,{color:\"inherit\",component:RouterLink,to:\"/\",children:\"Home\"}),/*#__PURE__*/_jsx(Button,{color:\"inherit\",component:RouterLink,to:\"/books\",children:\"Books\"}),/*#__PURE__*/_jsx(Button,{color:\"inherit\",component:RouterLink,to:\"/explore\",children:\"Explore\"}),/*#__PURE__*/_jsx(Button,{color:\"inherit\",component:RouterLink,to:\"/discussions\",children:\"Discussions\"}),/*#__PURE__*/_jsx(Button,{color:\"inherit\",component:RouterLink,to:\"/treehouse\",children:\"Treehouse\"}),isLoggedIn?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{color:\"inherit\",component:RouterLink,to:\"/profile\",children:\"Profile\"}),isAdmin&&/*#__PURE__*/_jsx(Button,{color:\"inherit\",component:RouterLink,to:\"/admin\",children:\"Admin Dashboard\"}),/*#__PURE__*/_jsx(Button,{color:\"inherit\",onClick:handleLogout,children:\"Logout\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{color:\"inherit\",component:RouterLink,to:\"/login\",children:\"Login\"}),/*#__PURE__*/_jsx(Button,{color:\"inherit\",component:RouterLink,to:\"/register\",children:\"Register\"})]})]})]})});}export default Navbar;","map":{"version":3,"names":["React","useState","useEffect","AppBar","Toolbar","Typography","Button","Box","IconButton","Brightness4","DarkIcon","Brightness7","LightIcon","Link","RouterLink","useNavigate","ThemeToggle","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Navbar","_ref","toggleTheme","currentTheme","isLoggedIn","setIsLoggedIn","isAdmin","setIsAdmin","navigate","checkAuthStatus","token","localStorage","getItem","console","log","storedUser","JSON","parse","response","fetch","headers","data","json","ok","removeItem","error","handleLogout","position","style","zIndex","children","variant","component","sx","flexGrow","display","alignItems","mr","color","to","onClick"],"sources":["/Users/BrooksCole/Documents/reading-community/frontend/src/components/Navbar.js"],"sourcesContent":["// frontend/src/components/Navbar.js\nimport React, { useState, useEffect } from 'react';\nimport { \n  AppBar, \n  Toolbar, \n  Typography, \n  Button, \n  Box,\n  IconButton,\n} from '@mui/material';\nimport { \n  Brightness4 as DarkIcon,\n  Brightness7 as LightIcon \n} from '@mui/icons-material';\nimport { Link as RouterLink, useNavigate } from 'react-router-dom';\nimport ThemeToggle from './ThemeToggle';\n\nfunction Navbar({ toggleTheme, currentTheme }) {\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [isAdmin, setIsAdmin] = useState(false);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const checkAuthStatus = async () => {\n      const token = localStorage.getItem('token');\n      console.log('Checking auth with token:', token);\n      \n      if (token) {\n        // First check stored user data\n        const storedUser = JSON.parse(localStorage.getItem('user'));\n        if (storedUser) {\n          setIsLoggedIn(true);\n          setIsAdmin(storedUser.isAdmin === true);\n        }\n  \n        try {\n          const response = await fetch('http://localhost:3001/api/auth/profile', {\n            headers: {\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          const data = await response.json();\n          console.log('Profile response:', data);\n          \n          if (response.ok) {\n            setIsLoggedIn(true);\n            setIsAdmin(data.isAdmin === true);\n            console.log('Is admin?', data.isAdmin);\n          } else {\n            console.log('Auth check failed:', data);\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            setIsLoggedIn(false);\n            setIsAdmin(false);\n          }\n        } catch (error) {\n          console.error('Auth check error:', error);\n          setIsLoggedIn(false);\n          setIsAdmin(false);\n        }\n      }\n    };\n\n    \n  \n    checkAuthStatus();\n  }, [localStorage.getItem('lastLogin')]);  // Add lastLogin as dependency\n\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    localStorage.removeItem('lastLogin');\n    setIsLoggedIn(false);\n    setIsAdmin(false);\n    navigate('/login');\n  };\n\n  return (\n    <AppBar position=\"fixed\" style={{ zIndex: 1100 }}>\n      <Toolbar>\n        <Typography variant=\"h6\" component=\"div\" sx={{ flexGrow: 1 }}>\n          Brooks'Bookhouse\n        </Typography>\n        <Box sx={{ display: 'flex', alignItems: 'center' }}>\n          <Box sx={{ mr: 2 }}>\n            <ThemeToggle currentTheme={currentTheme} toggleTheme={toggleTheme} />\n          </Box>\n          <Button color=\"inherit\" component={RouterLink} to=\"/\">\n            Home\n          </Button>\n          <Button color=\"inherit\" component={RouterLink} to=\"/books\">\n            Books\n          </Button>\n          <Button color=\"inherit\" component={RouterLink} to=\"/explore\">\n            Explore\n          </Button>\n          <Button color=\"inherit\" component={RouterLink} to=\"/discussions\">\n            Discussions\n          </Button>\n          <Button color=\"inherit\" component={RouterLink} to=\"/treehouse\">\n            Treehouse\n          </Button>\n          {isLoggedIn ? (\n            <>\n              <Button color=\"inherit\" component={RouterLink} to=\"/profile\">\n                Profile\n              </Button>\n              {isAdmin && (\n                <Button color=\"inherit\" component={RouterLink} to=\"/admin\">\n                  Admin Dashboard\n                </Button>\n              )}\n              <Button color=\"inherit\" onClick={handleLogout}>\n                Logout\n              </Button>\n            </>\n          ) : (\n            <>\n              <Button color=\"inherit\" component={RouterLink} to=\"/login\">\n                Login\n              </Button>\n              <Button color=\"inherit\" component={RouterLink} to=\"/register\">\n                Register\n              </Button>\n            </>\n          )}\n        </Box>\n      </Toolbar>\n    </AppBar>\n  );\n}\n\nexport default Navbar;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}