{"ast":null,"code":"import{useState}from'react';import{useNavigate}from'react-router-dom';import{Container,Box,Paper,Typography,TextField,Button}from'@mui/material';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){const navigate=useNavigate();const[formData,setFormData]=useState({username:'',password:''});const[error,setError]=useState('');const handleChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});};const handleSubmit=async e=>{e.preventDefault();console.log('Form submitted with data:',formData);setError('');try{console.log('Attempting fetch to login endpoint...');const response=await fetch('http://localhost:3001/api/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(formData)});console.log('Response received:',response);const data=await response.json();console.log('Login response data:',data);if(response.ok&&data.token){console.log('Login successful, setting token and user data...');console.log('User ID from response:',data.user.id);// Store all necessary data in localStorage\nlocalStorage.setItem('token',data.token);localStorage.setItem('userId',data.user.id);localStorage.setItem('user',JSON.stringify(data.user));localStorage.setItem('lastLogin',Date.now());// Verify data was stored\nconst storedUserId=localStorage.getItem('userId');console.log('Stored User ID:',storedUserId);// Navigate to home page\nnavigate('/');}else{console.log('Login failed:',data.error);setError(data.error||'Login failed');}}catch(err){console.error('Login error:',err);setError('Connection error. Please try again.');}};return/*#__PURE__*/_jsx(Container,{maxWidth:\"sm\",children:/*#__PURE__*/_jsx(Box,{sx:{mt:8},children:/*#__PURE__*/_jsxs(Paper,{sx:{p:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,children:\"Login\"}),error&&/*#__PURE__*/_jsx(Typography,{color:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Username\",name:\"username\",value:formData.username,onChange:handleChange,margin:\"normal\",required:true}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Password\",name:\"password\",type:\"password\",value:formData.password,onChange:handleChange,margin:\"normal\",required:true}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"primary\",sx:{mt:3},children:\"Login\"}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"text\",onClick:()=>navigate('/register'),sx:{mt:1},children:\"Don't have an account? Sign up\"})]})]})})});}export default Login;","map":{"version":3,"names":["useState","useNavigate","Container","Box","Paper","Typography","TextField","Button","jsx","_jsx","jsxs","_jsxs","Login","navigate","formData","setFormData","username","password","error","setError","handleChange","e","target","name","value","handleSubmit","preventDefault","console","log","response","fetch","method","headers","body","JSON","stringify","data","json","ok","token","user","id","localStorage","setItem","Date","now","storedUserId","getItem","err","maxWidth","children","sx","mt","p","variant","component","gutterBottom","color","mb","onSubmit","fullWidth","label","onChange","margin","required","type","onClick"],"sources":["/Users/BrooksCole/Documents/reading-community/frontend/src/pages/Login.js"],"sourcesContent":["import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { \n  Container, \n  Box, \n  Paper, \n  Typography, \n  TextField, \n  Button \n} from '@mui/material';\n\nfunction Login() {\n  const navigate = useNavigate();\n  const [formData, setFormData] = useState({\n    username: '',\n    password: ''\n  });\n  const [error, setError] = useState('');\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    console.log('Form submitted with data:', formData);\n    setError('');\n    \n    try {\n      console.log('Attempting fetch to login endpoint...');\n      const response = await fetch('http://localhost:3001/api/auth/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(formData)\n      });\n      \n      console.log('Response received:', response);\n      const data = await response.json();\n      console.log('Login response data:', data);\n      \n      if (response.ok && data.token) {\n        console.log('Login successful, setting token and user data...');\n        console.log('User ID from response:', data.user.id);\n        \n        // Store all necessary data in localStorage\n        localStorage.setItem('token', data.token);\n        localStorage.setItem('userId', data.user.id);\n        localStorage.setItem('user', JSON.stringify(data.user));\n        localStorage.setItem('lastLogin', Date.now());\n        \n        // Verify data was stored\n        const storedUserId = localStorage.getItem('userId');\n        console.log('Stored User ID:', storedUserId);\n        \n        // Navigate to home page\n        navigate('/');\n      } else {\n        console.log('Login failed:', data.error);\n        setError(data.error || 'Login failed');\n      }\n    } catch (err) {\n      console.error('Login error:', err);\n      setError('Connection error. Please try again.');\n    }\n  };\n\n  return (\n    <Container maxWidth=\"sm\">\n      <Box sx={{ mt: 8 }}>\n        <Paper sx={{ p: 4 }}>\n          <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n            Login\n          </Typography>\n          {error && (\n            <Typography color=\"error\" sx={{ mb: 2 }}>\n              {error}\n            </Typography>\n          )}\n          <form onSubmit={handleSubmit}>\n            <TextField\n              fullWidth\n              label=\"Username\"\n              name=\"username\"\n              value={formData.username}\n              onChange={handleChange}\n              margin=\"normal\"\n              required\n            />\n            <TextField\n              fullWidth\n              label=\"Password\"\n              name=\"password\"\n              type=\"password\"\n              value={formData.password}\n              onChange={handleChange}\n              margin=\"normal\"\n              required\n            />\n            <Button\n              type=\"submit\"\n              fullWidth\n              variant=\"contained\"\n              color=\"primary\"\n              sx={{ mt: 3 }}\n            >\n              Login\n            </Button>\n            <Button\n              fullWidth\n              variant=\"text\"\n              onClick={() => navigate('/register')}\n              sx={{ mt: 1 }}\n            >\n              Don't have an account? Sign up\n            </Button>\n          </form>\n        </Paper>\n      </Box>\n    </Container>\n  );\n}\n\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}